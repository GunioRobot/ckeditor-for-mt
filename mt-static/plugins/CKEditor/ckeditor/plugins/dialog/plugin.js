CKEDITOR.DIALOG_RESIZE_NONE=0;CKEDITOR.DIALOG_RESIZE_WIDTH=1;CKEDITOR.DIALOG_RESIZE_HEIGHT=2;CKEDITOR.DIALOG_RESIZE_BOTH=3;(function(){var a=CKEDITOR.tools.cssLength;function b(D){return!!this._.tabs[D][0].$.offsetHeight;};function c(){var H=this;var D=H._.currentTabId,E=H._.tabIdList.length,F=CKEDITOR.tools.indexOf(H._.tabIdList,D)+E;for(var G=F-1;G>F-E;G--){if(b.call(H,H._.tabIdList[G%E]))return H._.tabIdList[G%E];}return null;};function d(){var H=this;var D=H._.currentTabId,E=H._.tabIdList.length,F=CKEDITOR.tools.indexOf(H._.tabIdList,D);for(var G=F+1;G<F+E;G++){if(b.call(H,H._.tabIdList[G%E]))return H._.tabIdList[G%E];}return null;};function e(D,E){var F=D.$.getElementsByTagName('input');for(var G=0,H=F.length;G<H;G++){var I=new CKEDITOR.dom.element(F[G]);if(I.getAttribute('type').toLowerCase()=='text')if(E){I.setAttribute('value',I.getCustomData('fake_value')||'');I.removeCustomData('fake_value');}else{I.setCustomData('fake_value',I.getAttribute('value'));I.setAttribute('value','');}}};CKEDITOR.dialog=function(D,E){var F=CKEDITOR.dialog._.dialogDefinitions[E],G=CKEDITOR.tools.clone(g),H=D.config.dialog_buttonsOrder||'OS',I=D.lang.dir;if(H=='OS'&&CKEDITOR.env.mac||H=='rtl'&&I=='ltr'||H=='ltr'&&I=='rtl')G.buttons.reverse();F=CKEDITOR.tools.extend(F(D),G);F=CKEDITOR.tools.clone(F);F=new k(this,F);var J=CKEDITOR.document,K=D.theme.buildDialog(D);this._={editor:D,element:K.element,name:E,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:false,focusList:[],currentFocusIndex:0,hasFocus:false};this.parts=K.parts;CKEDITOR.tools.setTimeout(function(){D.fire('ariaWidget',this.parts.contents);},0,this);var L={position:CKEDITOR.env.ie6Compat?'absolute':'fixed',top:0,visibility:'hidden'};L[I=='rtl'?'right':'left']=0;this.parts.dialog.setStyles(L);CKEDITOR.event.call(this);this.definition=F=CKEDITOR.fire('dialogDefinition',{name:E,definition:F},D).definition;var M={};if(!('removeDialogTabs' in D._)&&D.config.removeDialogTabs){var N=D.config.removeDialogTabs.split(';');for(i=0;i<N.length;i++){var O=N[i].split(':');if(O.length==2){var P=O[0];if(!M[P])M[P]=[];M[P].push(O[1]);}}D._.removeDialogTabs=M;}if(D._.removeDialogTabs&&(M=D._.removeDialogTabs[E]))for(i=0;i<M.length;i++)F.removeContents(M[i]);if(F.onLoad)this.on('load',F.onLoad);if(F.onShow)this.on('show',F.onShow);if(F.onHide)this.on('hide',F.onHide);if(F.onOk)this.on('ok',function(ac){D.fire('saveSnapshot');
setTimeout(function(){D.fire('saveSnapshot');},0);if(F.onOk.call(this,ac)===false)ac.data.hide=false;});if(F.onCancel)this.on('cancel',function(ac){if(F.onCancel.call(this,ac)===false)ac.data.hide=false;});var Q=this,R=function(ac){var ad=Q._.contents,ae=false;for(var af in ad)for(var ag in ad[af]){ae=ac.call(this,ad[af][ag]);if(ae)return;}};this.on('ok',function(ac){R(function(ad){if(ad.validate){var ae=ad.validate(this);if(typeof ae=='string'){alert(ae);ae=false;}if(ae===false){if(ad.select)ad.select();else ad.focus();ac.data.hide=false;ac.stop();return true;}}});},this,null,0);this.on('cancel',function(ac){R(function(ad){if(ad.isChanged()){if(!confirm(D.lang.common.confirmCancel))ac.data.hide=false;return true;}});},this,null,0);this.parts.close.on('click',function(ac){if(this.fire('cancel',{hide:true}).hide!==false)this.hide();ac.data.preventDefault();},this);function S(){var ac=Q._.focusList;ac.sort(function(af,ag){if(af.tabIndex!=ag.tabIndex)return ag.tabIndex-af.tabIndex;else return af.focusIndex-ag.focusIndex;});var ad=ac.length;for(var ae=0;ae<ad;ae++)ac[ae].focusIndex=ae;};function T(ac){var ad=Q._.focusList,ae=ac?1:-1;if(ad.length<1)return;var af=Q._.currentFocusIndex;try{ad[af].getInputElement().$.blur();}catch(ai){}var ag=(af+ae+ad.length)%ad.length,ah=ag;while(!ad[ah].isFocusable()){ah=(ah+ae+ad.length)%ad.length;if(ah==ag)break;}ad[ah].focus();if(ad[ah].type=='text')ad[ah].select();};this.changeFocus=T;var U;function V(ac){var ah=this;if(Q!=CKEDITOR.dialog._.currentTop)return;var ad=ac.data.getKeystroke(),ae=D.lang.dir=='rtl';U=0;if(ad==9||ad==CKEDITOR.SHIFT+9){var af=ad==CKEDITOR.SHIFT+9;if(Q._.tabBarMode){var ag=af?c.call(Q):d.call(Q);Q.selectPage(ag);Q._.tabs[ag][0].focus();}else T(!af);U=1;}else if(ad==CKEDITOR.ALT+121&&!Q._.tabBarMode&&Q.getPageCount()>1){Q._.tabBarMode=true;Q._.tabs[Q._.currentTabId][0].focus();U=1;}else if((ad==37||ad==39)&&Q._.tabBarMode){ag=ad==(ae?39:37)?c.call(Q):d.call(Q);Q.selectPage(ag);Q._.tabs[ag][0].focus();U=1;}else if((ad==13||ad==32)&&Q._.tabBarMode){ah.selectPage(ah._.currentTabId);ah._.tabBarMode=false;ah._.currentFocusIndex=-1;T(true);U=1;}if(U){ac.stop();ac.data.preventDefault();}};function W(ac){U&&ac.data.preventDefault();};var X=this._.element;this.on('show',function(){X.on('keydown',V,this,null,0);if(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)X.on('keypress',W,this);});this.on('hide',function(){X.removeListener('keydown',V);if(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)X.removeListener('keypress',W);
});this.on('iframeAdded',function(ac){var ad=new CKEDITOR.dom.document(ac.data.iframe.$.contentWindow.document);ad.on('keydown',V,this,null,0);});this.on('show',function(){var ag=this;S();if(D.config.dialog_startupFocusTab&&Q._.pageCount>1){Q._.tabBarMode=true;Q._.tabs[Q._.currentTabId][0].focus();}else if(!ag._.hasFocus){ag._.currentFocusIndex=-1;if(F.onFocus){var ac=F.onFocus.call(ag);ac&&ac.focus();}else T(true);if(ag._.editor.mode=='wysiwyg'&&CKEDITOR.env.ie){var ad=D.document.$.selection,ae=ad.createRange();if(ae)if(ae.parentElement&&ae.parentElement().ownerDocument==D.document.$||ae.item&&ae.item(0).ownerDocument==D.document.$){var af=document.body.createTextRange();af.moveToElementText(ag.getElement().getFirst().$);af.collapse(true);af.select();}}}},this,null,4294967295);if(CKEDITOR.env.ie6Compat)this.on('load',function(ac){var ad=this.getElement(),ae=ad.getFirst();ae.remove();ae.appendTo(ad);},this);m(this);n(this);new CKEDITOR.dom.text(F.title,CKEDITOR.document).appendTo(this.parts.title);for(var Y=0;Y<F.contents.length;Y++){var Z=F.contents[Y];Z&&this.addPage(Z);}this.parts.tabs.on('click',function(ac){var af=this;var ad=ac.data.getTarget();if(ad.hasClass('cke_dialog_tab')){var ae=ad.$.id;af.selectPage(ae.substring(4,ae.lastIndexOf('_')));if(af._.tabBarMode){af._.tabBarMode=false;af._.currentFocusIndex=-1;T(true);}ac.data.preventDefault();}},this);var aa=[],ab=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:'hbox',className:'cke_dialog_footer_buttons',widths:[],children:F.buttons},aa).getChild();this.parts.footer.setHtml(aa.join(''));for(Y=0;Y<ab.length;Y++)this._.buttons[ab[Y].id]=ab[Y];};function f(D,E,F){this.element=E;this.focusIndex=F;this.tabIndex=0;this.isFocusable=function(){return!E.getAttribute('disabled')&&E.isVisible();};this.focus=function(){D._.currentFocusIndex=this.focusIndex;this.element.focus();};E.on('keydown',function(G){if(G.data.getKeystroke() in {32:1,13:1})this.fire('click');});E.on('focus',function(){this.fire('mouseover');});E.on('blur',function(){this.fire('mouseout');});};CKEDITOR.dialog.prototype={destroy:function(){this.hide();this._.element.remove();},resize:(function(){return function(D,E){var F=this;if(F._.contentSize&&F._.contentSize.width==D&&F._.contentSize.height==E)return;CKEDITOR.dialog.fire('resize',{dialog:F,skin:F._.editor.skinName,width:D,height:E},F._.editor);F.fire('resize',{skin:F._.editor.skinName,width:D,height:E},F._.editor);if(F._.editor.lang.dir=='rtl'&&F._.position)F._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-F._.contentSize.width-parseInt(F._.element.getFirst().getStyle('right'),10);
F._.contentSize={width:D,height:E};};})(),getSize:function(){var D=this._.element.getFirst();return{width:D.$.offsetWidth||0,height:D.$.offsetHeight||0};},move:(function(){var D;return function(E,F,G){var N=this;var H=N._.element.getFirst(),I=N._.editor.lang.dir=='rtl';if(D===undefined)D=H.getComputedStyle('position')=='fixed';if(D&&N._.position&&N._.position.x==E&&N._.position.y==F)return;N._.position={x:E,y:F};if(!D){var J=CKEDITOR.document.getWindow().getScrollPosition();E+=J.x;F+=J.y;}if(I){var K=N.getSize(),L=CKEDITOR.document.getWindow().getViewPaneSize();E=L.width-K.width-E;}var M={top:(F>0?F:0)+'px'};M[I?'right':'left']=(E>0?E:0)+'px';H.setStyles(M);G&&(N._.moved=1);};})(),getPosition:function(){return CKEDITOR.tools.extend({},this._.position);},show:function(){var D=this._.element,E=this.definition;if(!(D.getParent()&&D.getParent().equals(CKEDITOR.document.getBody())))D.appendTo(CKEDITOR.document.getBody());else D.setStyle('display','block');if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){var F=this.parts.dialog;F.setStyle('position','absolute');setTimeout(function(){F.setStyle('position','fixed');},0);}this.resize(this._.contentSize&&this._.contentSize.width||E.width||E.minWidth,this._.contentSize&&this._.contentSize.height||E.height||E.minHeight);this.reset();this.selectPage(this.definition.contents[0].id);if(CKEDITOR.dialog._.currentZIndex===null)CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex;this._.element.getFirst().setStyle('z-index',CKEDITOR.dialog._.currentZIndex+=10);if(CKEDITOR.dialog._.currentTop===null){CKEDITOR.dialog._.currentTop=this;this._.parentDialog=null;r(this._.editor);D.on('keydown',v);D.on(CKEDITOR.env.opera?'keypress':'keyup',w);for(var G in {keyup:1,keydown:1,keypress:1})D.on(G,C);}else{this._.parentDialog=CKEDITOR.dialog._.currentTop;var H=this._.parentDialog.getElement().getFirst();H.$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2);CKEDITOR.dialog._.currentTop=this;}x(this,this,'\x1b',null,function(){this.getButton('cancel')&&this.getButton('cancel').click();});this._.hasFocus=false;CKEDITOR.tools.setTimeout(function(){this.layout();this.parts.dialog.setStyle('visibility','');this.fireOnce('load',{});CKEDITOR.ui.fire('ready',this);this.fire('show',{});this._.editor.fire('dialogShow',this);this.foreach(function(I){I.setInitValue&&I.setInitValue();});},100,this);},layout:function(){var F=this;var D=CKEDITOR.document.getWindow().getViewPaneSize(),E=F.getSize();F.move(F._.moved?F._.position.x:(D.width-E.width)/2,F._.moved?F._.position.y:(D.height-E.height)/2);
},foreach:function(D){var G=this;for(var E in G._.contents)for(var F in G._.contents[E])D(G._.contents[E][F]);return G;},reset:(function(){var D=function(E){if(E.reset)E.reset(1);};return function(){this.foreach(D);return this;};})(),setupContent:function(){var D=arguments;this.foreach(function(E){if(E.setup)E.setup.apply(E,D);});},commitContent:function(){var D=arguments;this.foreach(function(E){if(E.commit)E.commit.apply(E,D);});},hide:function(){if(!this.parts.dialog.isVisible())return;this.fire('hide',{});this._.editor.fire('dialogHide',this);var D=this._.element;D.setStyle('display','none');this.parts.dialog.setStyle('visibility','hidden');y(this);while(CKEDITOR.dialog._.currentTop!=this)CKEDITOR.dialog._.currentTop.hide();if(!this._.parentDialog)s();else{var E=this._.parentDialog.getElement().getFirst();E.setStyle('z-index',parseInt(E.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2));}CKEDITOR.dialog._.currentTop=this._.parentDialog;if(!this._.parentDialog){CKEDITOR.dialog._.currentZIndex=null;D.removeListener('keydown',v);D.removeListener(CKEDITOR.env.opera?'keypress':'keyup',w);for(var F in {keyup:1,keydown:1,keypress:1})D.removeListener(F,C);var G=this._.editor;G.focus();if(G.mode=='wysiwyg'&&CKEDITOR.env.ie){var H=G.getSelection();H&&H.unlock(true);}}else CKEDITOR.dialog._.currentZIndex-=10;delete this._.parentDialog;this.foreach(function(I){I.resetInitValue&&I.resetInitValue();});},addPage:function(D){var P=this;var E=[],F=D.label?' title="'+CKEDITOR.tools.htmlEncode(D.label)+'"':'',G=D.elements,H=CKEDITOR.dialog._.uiElementBuilders.vbox.build(P,{type:'vbox',className:'cke_dialog_page_contents',children:D.elements,expand:!!D.expand,padding:D.padding,style:D.style||'width: 100%;height:100%'},E),I=CKEDITOR.dom.element.createFromHtml(E.join(''));I.setAttribute('role','tabpanel');var J=CKEDITOR.env,K='cke_'+D.id+'_'+CKEDITOR.tools.getNextNumber(),L=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',P._.pageCount>0?' cke_last':'cke_first',F,!!D.hidden?' style="display:none"':'',' id="',K,'"',J.gecko&&J.version>=10900&&!J.hc?'':' href="javascript:void(0)"',' tabIndex="-1"',' hidefocus="true"',' role="tab">',D.label,'</a>'].join(''));I.setAttribute('aria-labelledby',K);P._.tabs[D.id]=[L,I];P._.tabIdList.push(D.id);!D.hidden&&P._.pageCount++;P._.lastTab=L;P.updateStyle();var M=P._.contents[D.id]={},N,O=H.getChild();while(N=O.shift()){M[N.id]=N;if(typeof N.getChild=='function')O.push.apply(O,N.getChild());}I.setAttribute('name',D.id);
I.appendTo(P.parts.contents);L.unselectable();P.parts.tabs.append(L);if(D.accessKey){x(P,P,'CTRL+'+D.accessKey,A,z);P._.accessKeyMap['CTRL+'+D.accessKey]=D.id;}},selectPage:function(D){if(this._.currentTabId==D)return;if(this.fire('selectPage',{page:D,currentPage:this._.currentTabId})===true)return;for(var E in this._.tabs){var F=this._.tabs[E][0],G=this._.tabs[E][1];if(E!=D){F.removeClass('cke_dialog_tab_selected');G.hide();}G.setAttribute('aria-hidden',E!=D);}var H=this._.tabs[D];H[0].addClass('cke_dialog_tab_selected');if(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat){e(H[1]);H[1].show();setTimeout(function(){e(H[1],1);},0);}else H[1].show();this._.currentTabId=D;this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,D);},updateStyle:function(){this.parts.dialog[(this._.pageCount===1?'add':'remove')+'Class']('cke_single_page');},hidePage:function(D){var F=this;var E=F._.tabs[D]&&F._.tabs[D][0];if(!E||F._.pageCount==1||!E.isVisible())return;else if(D==F._.currentTabId)F.selectPage(c.call(F));E.hide();F._.pageCount--;F.updateStyle();},showPage:function(D){var F=this;var E=F._.tabs[D]&&F._.tabs[D][0];if(!E)return;E.show();F._.pageCount++;F.updateStyle();},getElement:function(){return this._.element;},getName:function(){return this._.name;},getContentElement:function(D,E){var F=this._.contents[D];return F&&F[E];},getValueOf:function(D,E){return this.getContentElement(D,E).getValue();},setValueOf:function(D,E,F){return this.getContentElement(D,E).setValue(F);},getButton:function(D){return this._.buttons[D];},click:function(D){return this._.buttons[D].click();},disableButton:function(D){return this._.buttons[D].disable();},enableButton:function(D){return this._.buttons[D].enable();},getPageCount:function(){return this._.pageCount;},getParentEditor:function(){return this._.editor;},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement();},addFocusable:function(D,E){var G=this;if(typeof E=='undefined'){E=G._.focusList.length;G._.focusList.push(new f(G,D,E));}else{G._.focusList.splice(E,0,new f(G,D,E));for(var F=E+1;F<G._.focusList.length;F++)G._.focusList[F].focusIndex++;}}};CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(D,E){if(!this._.dialogDefinitions[D]||typeof E=='function')this._.dialogDefinitions[D]=E;},exists:function(D){return!!this._.dialogDefinitions[D];},getCurrent:function(){return CKEDITOR.dialog._.currentTop;},okButton:(function(){var D=function(E,F){F=F||{};return CKEDITOR.tools.extend({id:'ok',type:'button',label:E.lang.common.ok,'class':'cke_dialog_ui_button_ok',onClick:function(G){var H=G.data.dialog;
if(H.fire('ok',{hide:true}).hide!==false)H.hide();}},F,true);};D.type='button';D.override=function(E){return CKEDITOR.tools.extend(function(F){return D(F,E);},{type:'button'},true);};return D;})(),cancelButton:(function(){var D=function(E,F){F=F||{};return CKEDITOR.tools.extend({id:'cancel',type:'button',label:E.lang.common.cancel,'class':'cke_dialog_ui_button_cancel',onClick:function(G){var H=G.data.dialog;if(H.fire('cancel',{hide:true}).hide!==false)H.hide();}},F,true);};D.type='button';D.override=function(E){return CKEDITOR.tools.extend(function(F){return D(F,E);},{type:'button'},true);};return D;})(),addUIElement:function(D,E){this._.uiElementBuilders[D]=E;}});CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null};CKEDITOR.event.implementOn(CKEDITOR.dialog);CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype,true);var g={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},h=function(D,E,F){for(var G=0,H;H=D[G];G++){if(H.id==E)return H;if(F&&H[F]){var I=h(H[F],E,F);if(I)return I;}}return null;},i=function(D,E,F,G,H){if(F){for(var I=0,J;J=D[I];I++){if(J.id==F){D.splice(I,0,E);return E;}if(G&&J[G]){var K=i(J[G],E,F,G,true);if(K)return K;}}if(H)return null;}D.push(E);return E;},j=function(D,E,F){for(var G=0,H;H=D[G];G++){if(H.id==E)return D.splice(G,1);if(F&&H[F]){var I=j(H[F],E,F);if(I)return I;}}return null;},k=function(D,E){this.dialog=D;var F=E.contents;for(var G=0,H;H=F[G];G++)F[G]=H&&new l(D,H);CKEDITOR.tools.extend(this,E);};k.prototype={getContents:function(D){return h(this.contents,D);},getButton:function(D){return h(this.buttons,D);},addContents:function(D,E){return i(this.contents,D,E);},addButton:function(D,E){return i(this.buttons,D,E);},removeContents:function(D){j(this.contents,D);},removeButton:function(D){j(this.buttons,D);}};function l(D,E){this._={dialog:D};CKEDITOR.tools.extend(this,E);};l.prototype={get:function(D){return h(this.elements,D,'children');},add:function(D,E){return i(this.elements,D,E,'children');},remove:function(D){j(this.elements,D,'children');}};function m(D){var E=null,F=null,G=D.getElement().getFirst(),H=D.getParentEditor(),I=H.config.dialog_magnetDistance,J=H.skin.margins||[0,0,0,0];if(typeof I=='undefined')I=20;function K(M){var N=D.getSize(),O=CKEDITOR.document.getWindow().getViewPaneSize(),P=M.data.$.screenX,Q=M.data.$.screenY,R=P-E.x,S=Q-E.y,T,U;E={x:P,y:Q};F.x+=R;F.y+=S;if(F.x+J[3]<I)T=-J[3];else if(F.x-J[1]>O.width-N.width-I)T=O.width-N.width+(H.lang.dir=='rtl'?0:J[1]);
else T=F.x;if(F.y+J[0]<I)U=-J[0];else if(F.y-J[2]>O.height-N.height-I)U=O.height-N.height+J[2];else U=F.y;D.move(T,U,1);M.data.preventDefault();};function L(M){CKEDITOR.document.removeListener('mousemove',K);CKEDITOR.document.removeListener('mouseup',L);if(CKEDITOR.env.ie6Compat){var N=q.getChild(0).getFrameDocument();N.removeListener('mousemove',K);N.removeListener('mouseup',L);}};D.parts.title.on('mousedown',function(M){E={x:M.data.$.screenX,y:M.data.$.screenY};CKEDITOR.document.on('mousemove',K);CKEDITOR.document.on('mouseup',L);F=D.getPosition();if(CKEDITOR.env.ie6Compat){var N=q.getChild(0).getFrameDocument();N.on('mousemove',K);N.on('mouseup',L);}M.data.preventDefault();},D);};function n(D){var E=D.definition,F=E.resizable;if(F==CKEDITOR.DIALOG_RESIZE_NONE)return;var G=D.getParentEditor(),H,I,J,K,L,M,N=CKEDITOR.tools.addFunction(function(Q){L=D.getSize();var R=D.parts.contents,S=R.$.getElementsByTagName('iframe').length;if(S){M=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>');R.append(M);}I=L.height-D.parts.contents.getSize('height',!(CKEDITOR.env.gecko||CKEDITOR.env.opera||CKEDITOR.env.ie&&CKEDITOR.env.quirks));H=L.width-D.parts.contents.getSize('width',1);K={x:Q.screenX,y:Q.screenY};J=CKEDITOR.document.getWindow().getViewPaneSize();CKEDITOR.document.on('mousemove',O);CKEDITOR.document.on('mouseup',P);if(CKEDITOR.env.ie6Compat){var T=q.getChild(0).getFrameDocument();T.on('mousemove',O);T.on('mouseup',P);}Q.preventDefault&&Q.preventDefault();});D.on('load',function(){var Q='';if(F==CKEDITOR.DIALOG_RESIZE_WIDTH)Q=' cke_resizer_horizontal';else if(F==CKEDITOR.DIALOG_RESIZE_HEIGHT)Q=' cke_resizer_vertical';var R=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+Q+' cke_resizer_'+G.lang.dir+'"'+' title="'+CKEDITOR.tools.htmlEncode(G.lang.resize)+'"'+' onmousedown="CKEDITOR.tools.callFunction('+N+', event )"></div>');D.parts.footer.append(R,1);});G.on('destroy',function(){CKEDITOR.tools.removeFunction(N);});function O(Q){var R=G.lang.dir=='rtl',S=(Q.data.$.screenX-K.x)*(R?-1:1),T=Q.data.$.screenY-K.y,U=L.width,V=L.height,W=U+S*(D._.moved?1:2),X=V+T*(D._.moved?1:2),Y=D._.element.getFirst(),Z=R&&Y.getComputedStyle('right'),aa=D.getPosition();if(aa.y+X>J.height)X=J.height-aa.y;if((R?Z:aa.x)+W>J.width)W=J.width-(R?Z:aa.x);if(F==CKEDITOR.DIALOG_RESIZE_WIDTH||F==CKEDITOR.DIALOG_RESIZE_BOTH)U=Math.max(E.minWidth||0,W-H);if(F==CKEDITOR.DIALOG_RESIZE_HEIGHT||F==CKEDITOR.DIALOG_RESIZE_BOTH)V=Math.max(E.minHeight||0,X-I);
D.resize(U,V);if(!D._.moved)D.layout();Q.data.preventDefault();};function P(){CKEDITOR.document.removeListener('mouseup',P);CKEDITOR.document.removeListener('mousemove',O);if(M){M.remove();M=null;}if(CKEDITOR.env.ie6Compat){var Q=q.getChild(0).getFrameDocument();Q.removeListener('mouseup',P);Q.removeListener('mousemove',O);}};};var o,p={},q;function r(D){var E=CKEDITOR.document.getWindow(),F=D.config,G=F.dialog_backgroundCoverColor||'white',H=F.dialog_backgroundCoverOpacity,I=F.baseFloatZIndex,J=CKEDITOR.tools.genKey(G,H,I),K=p[J];if(!K){var L=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?'absolute':'fixed','; z-index: ',I,'; top: 0px; left: 0px; ',!CKEDITOR.env.ie6Compat?'background-color: '+G:'','" class="cke_dialog_background_cover">'];if(CKEDITOR.env.ie6Compat){var M=CKEDITOR.env.isCustomDomain(),N="<html><body style=\\'background-color:"+G+";\\'></body></html>";L.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:');L.push('void((function(){document.open();'+(M?"document.domain='"+document.domain+"';":'')+"document.write( '"+N+"' );"+'document.close();'+'})())');L.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>');}L.push('</div>');K=CKEDITOR.dom.element.createFromHtml(L.join(''));K.setOpacity(H!=undefined?H:0.5);K.appendTo(CKEDITOR.document.getBody());p[J]=K;}else K.show();q=K;var O=function(){var R=E.getViewPaneSize();K.setStyles({width:R.width+'px',height:R.height+'px'});},P=function(){var R=E.getScrollPosition(),S=CKEDITOR.dialog._.currentTop;K.setStyles({left:R.x+'px',top:R.y+'px'});if(S)do{var T=S.getPosition();S.move(T.x,T.y);}while(S=S._.parentDialog)};o=O;E.on('resize',O);O();if(!(CKEDITOR.env.mac&&CKEDITOR.env.webkit))K.focus();if(CKEDITOR.env.ie6Compat){var Q=function(){P();arguments.callee.prevScrollHandler.apply(this,arguments);};E.$.setTimeout(function(){Q.prevScrollHandler=window.onscroll||(function(){});window.onscroll=Q;},0);P();}};function s(){if(!q)return;var D=CKEDITOR.document.getWindow();q.hide();D.removeListener('resize',o);if(CKEDITOR.env.ie6Compat)D.$.setTimeout(function(){var E=window.onscroll&&window.onscroll.prevScrollHandler;window.onscroll=E||null;},0);o=null;};function t(){for(var D in p)p[D].remove();p={};};var u={},v=function(D){var E=D.data.$.ctrlKey||D.data.$.metaKey,F=D.data.$.altKey,G=D.data.$.shiftKey,H=String.fromCharCode(D.data.$.keyCode),I=u[(E?'CTRL+':'')+(F?'ALT+':'')+(G?'SHIFT+':'')+H];
if(!I||!I.length)return;I=I[I.length-1];I.keydown&&I.keydown.call(I.uiElement,I.dialog,I.key);D.data.preventDefault();},w=function(D){var E=D.data.$.ctrlKey||D.data.$.metaKey,F=D.data.$.altKey,G=D.data.$.shiftKey,H=String.fromCharCode(D.data.$.keyCode),I=u[(E?'CTRL+':'')+(F?'ALT+':'')+(G?'SHIFT+':'')+H];if(!I||!I.length)return;I=I[I.length-1];if(I.keyup){I.keyup.call(I.uiElement,I.dialog,I.key);D.data.preventDefault();}},x=function(D,E,F,G,H){var I=u[F]||(u[F]=[]);I.push({uiElement:D,dialog:E,key:F,keyup:H||D.accessKeyUp,keydown:G||D.accessKeyDown});},y=function(D){for(var E in u){var F=u[E];for(var G=F.length-1;G>=0;G--){if(F[G].dialog==D||F[G].uiElement==D)F.splice(G,1);}if(F.length===0)delete u[E];}},z=function(D,E){if(D._.accessKeyMap[E])D.selectPage(D._.accessKeyMap[E]);},A=function(D,E){},B={27:1,13:1},C=function(D){if(D.data.getKeystroke() in B)D.data.stopPropagation();};(function(){CKEDITOR.ui.dialog={uiElement:function(D,E,F,G,H,I,J){if(arguments.length<4)return;var K=(G.call?G(E):G)||'div',L=['<',K,' '],M=(H&&H.call?H(E):H)||{},N=(I&&I.call?I(E):I)||{},O=(J&&J.call?J.call(this,D,E):J)||'',P=this.domId=N.id||CKEDITOR.tools.getNextId()+'_uiElement',Q=this.id=E.id,R;N.id=P;var S={};if(E.type)S['cke_dialog_ui_'+E.type]=1;if(E.className)S[E.className]=1;var T=N['class']&&N['class'].split?N['class'].split(' '):[];for(R=0;R<T.length;R++){if(T[R])S[T[R]]=1;}var U=[];for(R in S)U.push(R);N['class']=U.join(' ');if(E.title)N.title=E.title;var V=(E.style||'').split(';');for(R in M)V.push(R+':'+M[R]);if(E.hidden)V.push('display:none');for(R=V.length-1;R>=0;R--){if(V[R]==='')V.splice(R,1);}if(V.length>0)N.style=(N.style?N.style+'; ':'')+V.join('; ');for(R in N)L.push(R+'="'+CKEDITOR.tools.htmlEncode(N[R])+'" ');L.push('>',O,'</',K,'>');F.push(L.join(''));(this._||(this._={})).dialog=D;if(typeof E.isChanged=='boolean')this.isChanged=function(){return E.isChanged;};if(typeof E.isChanged=='function')this.isChanged=E.isChanged;CKEDITOR.event.implementOn(this);this.registerEvents(E);if(this.accessKeyUp&&this.accessKeyDown&&E.accessKey)x(this,D,'CTRL+'+E.accessKey);var W=this;D.on('load',function(){if(W.getInputElement())W.getInputElement().on('focus',function(){D._.tabBarMode=false;D._.hasFocus=true;W.fire('focus');},W);});if(this.keyboardFocusable){this.tabIndex=E.tabIndex||0;this.focusIndex=D._.focusList.push(this)-1;this.on('focus',function(){D._.currentFocusIndex=W.focusIndex;});}CKEDITOR.tools.extend(this,E);},hbox:function(D,E,F,G,H){if(arguments.length<4)return;
this._||(this._={});var I=this._.children=E,J=H&&H.widths||null,K=H&&H.height||null,L={},M,N=function(){var P=['<tbody><tr class="cke_dialog_ui_hbox">'];for(M=0;M<F.length;M++){var Q='cke_dialog_ui_hbox_child',R=[];if(M===0)Q='cke_dialog_ui_hbox_first';if(M==F.length-1)Q='cke_dialog_ui_hbox_last';P.push('<td class="',Q,'" role="presentation" ');if(J){if(J[M])R.push('width:'+a(J[M]));}else R.push('width:'+Math.floor(100/F.length)+'%');if(K)R.push('height:'+a(K));if(H&&H.padding!=undefined)R.push('padding:'+a(H.padding));if(R.length>0)P.push('style="'+R.join('; ')+'" ');P.push('>',F[M],'</td>');}P.push('</tr></tbody>');return P.join('');},O={role:'presentation'};H&&H.align&&(O.align=H.align);CKEDITOR.ui.dialog.uiElement.call(this,D,H||{type:'hbox'},G,'table',L,O,N);},vbox:function(D,E,F,G,H){if(arguments.length<3)return;this._||(this._={});var I=this._.children=E,J=H&&H.width||null,K=H&&H.heights||null,L=function(){var M=['<table role="presentation" cellspacing="0" border="0" '];M.push('style="');if(H&&H.expand)M.push('height:100%;');M.push('width:'+a(J||'100%'),';');M.push('"');M.push('align="',CKEDITOR.tools.htmlEncode(H&&H.align||(D.getParentEditor().lang.dir=='ltr'?'left':'right')),'" ');M.push('><tbody>');for(var N=0;N<F.length;N++){var O=[];M.push('<tr><td role="presentation" ');if(J)O.push('width:'+a(J||'100%'));if(K)O.push('height:'+a(K[N]));else if(H&&H.expand)O.push('height:'+Math.floor(100/F.length)+'%');if(H&&H.padding!=undefined)O.push('padding:'+a(H.padding));if(O.length>0)M.push('style="',O.join('; '),'" ');M.push(' class="cke_dialog_ui_vbox_child">',F[N],'</td></tr>');}M.push('</tbody></table>');return M.join('');};CKEDITOR.ui.dialog.uiElement.call(this,D,H||{type:'vbox'},G,'div',null,{role:'presentation'},L);}};})();CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId);},getInputElement:function(){return this.getElement();},getDialog:function(){return this._.dialog;},setValue:function(D,E){this.getInputElement().setValue(D);!E&&this.fire('change',{value:D});return this;},getValue:function(){return this.getInputElement().getValue();},isChanged:function(){return false;},selectParentTab:function(){var G=this;var D=G.getInputElement(),E=D,F;while((E=E.getParent())&&E.$.className.search('cke_dialog_page_contents')==-1){}if(!E)return G;F=E.getAttribute('name');if(G._.dialog._.currentTabId!=F)G._.dialog.selectPage(F);return G;},focus:function(){this.selectParentTab().getInputElement().focus();return this;
},registerEvents:function(D){var E=/^on([A-Z]\w+)/,F,G=function(I,J,K,L){J.on('load',function(){I.getInputElement().on(K,L,I);});};for(var H in D){if(!(F=H.match(E)))continue;if(this.eventProcessors[H])this.eventProcessors[H].call(this,this._.dialog,D[H]);else G(this,this._.dialog,F[1].toLowerCase(),D[H]);}return this;},eventProcessors:{onLoad:function(D,E){D.on('load',E,this);},onShow:function(D,E){D.on('show',E,this);},onHide:function(D,E){D.on('hide',E,this);}},accessKeyDown:function(D,E){this.focus();},accessKeyUp:function(D,E){},disable:function(){var D=this.getInputElement();D.setAttribute('disabled','true');D.addClass('cke_disabled');},enable:function(){var D=this.getInputElement();D.removeAttribute('disabled');D.removeClass('cke_disabled');},isEnabled:function(){return!this.getInputElement().getAttribute('disabled');},isVisible:function(){return this.getInputElement().isVisible();},isFocusable:function(){if(!this.isEnabled()||!this.isVisible())return false;return true;}};CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement(),{getChild:function(D){var E=this;if(arguments.length<1)return E._.children.concat();if(!D.splice)D=[D];if(D.length<2)return E._.children[D[0]];else return E._.children[D[0]]&&E._.children[D[0]].getChild?E._.children[D[0]].getChild(D.slice(1,D.length)):null;}},true);CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox();(function(){var D={build:function(E,F,G){var H=F.children,I,J=[],K=[];for(var L=0;L<H.length&&(I=H[L]);L++){var M=[];J.push(M);K.push(CKEDITOR.dialog._.uiElementBuilders[I.type].build(E,I,M));}return new CKEDITOR.ui.dialog[F.type](E,K,J,G,F);}};CKEDITOR.dialog.addUIElement('hbox',D);CKEDITOR.dialog.addUIElement('vbox',D);})();CKEDITOR.dialogCommand=function(D){this.dialogName=D;};CKEDITOR.dialogCommand.prototype={exec:function(D){D.openDialog(this.dialogName);},canUndo:false,editorFocus:CKEDITOR.env.ie||CKEDITOR.env.webkit};(function(){var D=/^([a]|[^a])+$/,E=/^\d*$/,F=/^\d*(?:\.\d+)?$/;CKEDITOR.VALIDATE_OR=1;CKEDITOR.VALIDATE_AND=2;CKEDITOR.dialog.validate={functions:function(){return function(){var M=this;var G=M&&M.getValue?M.getValue():arguments[0],H=undefined,I=CKEDITOR.VALIDATE_AND,J=[],K;for(K=0;K<arguments.length;K++){if(typeof arguments[K]=='function')J.push(arguments[K]);else break;}if(K<arguments.length&&typeof arguments[K]=='string'){H=arguments[K];K++;}if(K<arguments.length&&typeof arguments[K]=='number')I=arguments[K];var L=I==CKEDITOR.VALIDATE_AND?true:false;
for(K=0;K<J.length;K++){if(I==CKEDITOR.VALIDATE_AND)L=L&&J[K](G);else L=L||J[K](G);}if(!L){if(H!==undefined)alert(H);if(M&&(M.select||M.focus))M.select||M.focus();return false;}return true;};},regex:function(G,H){return function(){var J=this;var I=J&&J.getValue?J.getValue():arguments[0];if(!G.test(I)){if(H!==undefined)alert(H);if(J&&(J.select||J.focus))if(J.select)J.select();else J.focus();return false;}return true;};},notEmpty:function(G){return this.regex(D,G);},integer:function(G){return this.regex(E,G);},number:function(G){return this.regex(F,G);},equals:function(G,H){return this.functions(function(I){return I==G;},H);},notEqual:function(G,H){return this.functions(function(I){return I!=G;},H);}};CKEDITOR.on('instanceDestroyed',function(G){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){var H;while(H=CKEDITOR.dialog._.currentTop)H.hide();t();}var I=G.editor._.storedDialogs;for(var J in I)I[J].destroy();});})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(D,E){if(this.mode=='wysiwyg'&&CKEDITOR.env.ie){var F=this.getSelection();F&&F.lock();}var G=CKEDITOR.dialog._.dialogDefinitions[D],H=this.skin.dialog;if(CKEDITOR.dialog._.currentTop===null)r(this);if(typeof G=='function'&&H._isLoaded){var I=this._.storedDialogs||(this._.storedDialogs={}),J=I[D]||(I[D]=new CKEDITOR.dialog(this,D));E&&E.call(J,J);J.show();return J;}else if(G=='failed'){s();throw new Error('[CKEDITOR.dialog.openDialog] Dialog "'+D+'" failed when loading definition.');}var K=this;function L(N){var O=CKEDITOR.dialog._.dialogDefinitions[D],P=K.skin.dialog;if(!P._isLoaded||M&&typeof N=='undefined')return;if(typeof O!='function')CKEDITOR.dialog._.dialogDefinitions[D]='failed';K.openDialog(D,E);};if(typeof G=='string'){var M=1;CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(G),L,null,0,1);}CKEDITOR.skins.load(this,'dialog',L);return null;}});})();CKEDITOR.plugins.add('dialog',{requires:['dialogui']});
